<?xml version="1.0" encoding="utf-8"?>
<InstructionData xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <DateTime>132954138310147748</DateTime>
  <GameVersion>0.2.3229.16142</GameVersion>
  <Title>PC-AV2-HP - Pressure Control Dual Activve Vent</Title>
  <Description>â€‹</Description>
  <Author>Unknown</Author>
  <WorkshopFileHandle>0</WorkshopFileHandle>
  <Instructions># Atmospheric Reglator
# https://github.com/dtandersen/stationeers-library
alias GasSensor d0
alias Intake d1
alias Relief d2

define targetpres 101.325
#define targetpres 90
define deadzone 1
define purgepres 105

alias device r0
alias maxpres r1
alias minpres r2
alias pressure r3
alias spmin r4
alias spmax r5
alias reliefPres r6
alias ratioH2 r7
alias ratioX r8
alias ratioBad r9
alias purgeOn r10
alias hazard r10
alias intakePres r11
alias selector r13
alias temp r14

init:
move spmin 100
move spmax 102
add maxpres spmax deadzone
sub minpres spmin deadzone
s Intake Lock 0
s Intake Mode 1
s Intake On 1
s Relief Lock 0
s Relief Mode 1
s Relief On 1

move intakePres spmin
move reliefPres spmax
loop:
jal checkhazard

l pressure GasSensor Pressure
bnez purgeOn pos
neg:
slt selector pressure intakePres
select intakePres selector minpres spmin

sgt selector pressure reliefPres
select reliefPres selector maxpres spmax
j set
pos:
slt selector pressure intakePres
select intakePres selector maxpres spmax

sgt selector pressure reliefPres
select reliefPres selector minpres spmin

set:
s Intake PressureExternal 0
s Intake PressureInternal intakePres

#s Intake On 1

s Relief PressureExternal reliefPres
s Relief PressureInternal 40000
#s Relief Mode 1
#s Relief On 1

move temp intakePres
round temp temp
mul temp temp 100000
add temp temp reliefPres
round temp temp
s db Setting temp
yield
j loop

checkhazard:
l ratioH2 GasSensor RatioVolatiles
l ratioX GasSensor RatioPollutant
max ratioBad ratioX ratioH2
sgt purgeOn ratioBad 0.005
j ra</Instructions>
</InstructionData>